<script type="text/javascript" src="http://cs.brown.edu/people/jchua/sketchy/js/jquery.min.js"></script>
<script type="text/javascript" src="http://cs.brown.edu/people/jchua/sketchy/js/raphael.min.js"></script>
<script type="text/javascript" src="http://cs.brown.edu/people/jchua/sketchy/js/json2.min.js"></script>
<script type="text/javascript" src="http://cs.brown.edu/people/jchua/sketchy/js/raphael.sketchpad.smooth.js"></script>
 
<!-- <div id="viewer" style="border:1px solid #ccc;width:480px;height:480px"></div> -->

<div id="canvas" style="background-image: url(https://cs.brown.edu/people/jchua/sketchy/svgSubset/car/3612.svg);border:1px solid #ccc;width:420px;height:420px"></div>

<p id="test1"> ok </p>


<script>

function saveDaPicture(){
    var img = document.getElementById('canvas').toDataURL("image/png");
    $('body').append('<img src="'+img+'"/>');
}

$('#save').click(function(){
    var svg = $('#ec').html().replace(/>\s+/g, ">").replace(/\s+</g, "<");
                             // strips off all spaces between tags
    //alert(svg);
    canvg('canvas', svg, {renderCallback: saveDaPicture, ignoreMouse: true, ignoreAnimation: true});
});
var strokes = [{"fill":"none","stroke":"#FF0000","path":[["M",87.99999904632568,160.57142639160156],["C",87.99999904632568,160.57142639160156,94.436505973386,150.61375510689467,101.99999904632568,145.57142639160156],["C",110.82407429808865,139.68870955709292,113.64422788599961,141.88207826869186,123.99999904632568,136.57142639160156],["C",132.80938819330828,132.05379093161048,132.31834838980302,130.53236962390022,140.99999904632568,125.57142639160156],["C",146.1663801118637,122.61920863986555,146.43920100196507,121.96162590269171,151.99999904632568,120.57142639160156],["C",163.8025091812951,117.6207988578592,164.58105030178942,117.75418341489073,176.99999904632568,116.57142639160156],["C",185.31813169510514,115.779223282194,185.9430173440221,115.25301120395189,193.99999904632568,116.57142639160156],["C",212.7077073625835,119.63268775244376,214.7513810772857,119.00052430815776,231.99999904632568,125.57142639160156],["C",244.78776754061394,130.4429572465685,246.7392307949606,131.81223398189965,256.9999990463257,140.57142639160156],["C",265.9765163036489,148.2343069771214,272.9999990463257,160.57142639160156,272.9999990463257,160.57142639160156]],"stroke-opacity":1,"stroke-width":3,"stroke-linecap":"round","stroke-linejoin":"round","type":"path"},{"fill":"none","stroke":"#FF0000","path":[["M",273.9999990463257,161.7142791748047],["C",273.9999990463257,161.7142791748047,287.8430876671271,155.1308547342493,300.9999990463257,152.7142791748047],["C",311.10195806824595,150.85881731363565,312.76869126904523,150.88725992886174,322.9999990463257,152.7142791748047],["C",339.6424834502787,155.6861513897963,343.086632620299,156.06006044931365,356.9999990463257,162.7142791748047],["C",363.3639603712348,165.75791285193512,365.34786329834924,168.20395023275975,368.9999990463257,174.7142791748047],["C",375.8572643439585,186.93809992275885,377.2436308458886,189.93243817261927,379.9999990463257,203.7142791748047],["C",381.8375778466171,212.90217317626164,381.76086935741324,217.70591607742855,378.9999990463257,224.7142791748047],["C",376.8413582365235,230.19390584584102,373.31870432218744,234.0062626280068,366.9999990463257,236.7142791748047],["C",348.88637725552195,244.477259942292,344.9908538082399,244.9309063125399,322.9999990463257,248.7142791748047],["C",299.27923810916286,252.79527030377895,296.831720734207,254.30718999023827,273.9999990463257,252.7142791748047],["C",256.33402250405567,251.48176918348352,255.5727508281219,246.84155734853718,236.99999904632568,242.7142791748047],["C",224.26740434039172,239.88481368459713,223.9576429386281,239.5343832186213,210.99999904632568,238.7142791748047],["C",184.80981428425633,237.05667254429397,183.76154453660914,240.31937928056368,157.99999904632568,237.7142791748047],["C",140.14244021725912,235.90845861905638,139.28855168261126,234.83681328925968,121.99999904632568,229.7142791748047],["C",112.82171338034395,226.99478712562492,112.72851495699334,222.97928148069855,103.99999904632568,221.7142791748047],["C",80.63372233841883,218.3278622606153,72.80831627074338,222.735886887004,52.999999046325684,219.7142791748047],["C",49.49902457818447,219.18023222203738,47.037426111464455,216.51747636306374,44.999999046325684,212.7142791748047],["C",40.53184412182832,204.37372331574295,39.83700537100003,201.94902869799037,37.999999046325684,191.7142791748047],["C",36.51430959941163,183.43686654199786,37.019673963039395,181.88365486885712,37.999999046325684,173.7142791748047],["C",38.400843080380525,170.3739122243477,39.12408042114965,169.66215130008132,40.999999046325684,166.7142791748047],["C",42.37822497502644,164.54849557256063,43.32609219627112,162.92351753106152,44.999999046325684,162.7142791748047],["C",61.46008307186224,160.6567686716126,76.87918762510799,161.79168463446848,88.99999904632568,160.7142791748047],["C",89.32313939105633,160.6855555886064,89.99999904632568,158.7142791748047,89.99999904632568,158.7142791748047]],"stroke-opacity":1,"stroke-width":3,"stroke-linecap":"round","stroke-linejoin":"round","type":"path"},{"fill":"none","stroke":"#FF0000","path":[["M",114.99999904632568,214.7142791748047],["C",114.99999904632568,214.7142791748047,114.7166350345791,210.21120424862784,112.99999904632568,207.7142791748047],["C",109.88699497807507,203.18627325734923,107.72222151383812,199.706871832808,103.99999904632568,198.7142791748047],["C",97.23034297968026,196.90903755703258,89.27652345369047,196.76062063016244,82.99999904632568,199.7142791748047],["C",77.13617761369173,202.47372455486772,72.89623006098597,207.570242671976,69.99999904632568,214.7142791748047],["C",66.74077374449465,222.75370158598793,67.32043920006147,226.29436153208687,67.99999904632568,236.7142791748047],["C",68.75589116160366,248.30462494240038,69.49554341260927,252.8966473765142,72.99999904632568,260.7142791748047],["C",74.14666061373092,263.2722165174779,77.28717954359021,264.83027453129625,80.99999904632568,265.7142791748047],["C",86.25181108905512,266.9647106135498,87.87543653729726,266.5131351542432,93.99999904632568,265.7142791748047],["C",98.89555235621796,265.0757287430796,100.74355628998427,265.262799592811,103.99999904632568,262.7142791748047],["C",110.52435090674211,257.6082646753483,113.41036657548307,255.1178961459176,116.99999904632568,247.7142791748047],["C",120.27815558442093,240.95308131498325,120.2362797960714,237.98410541590454,119.99999904632568,229.7142791748047],["C",119.77426990900881,221.81375936871407,115.99999904632568,212.7142791748047,115.99999904632568,212.7142791748047]],"stroke-opacity":1,"stroke-width":3,"stroke-linecap":"round","stroke-linejoin":"round","type":"path"},{"fill":"none","stroke":"#FF0000","path":[["M",276.9999990463257,237.85713958740234],["C",276.9999990463257,237.85713958740234,269.85882161768455,245.59083317209044,267.9999990463257,252.85713958740234],["C",264.936939271479,264.8309187072577,264.63117797072556,268.5377499070012,265.9999990463257,280.85713958740234],["C",266.87604453470976,288.74154898285906,268.83009613307024,292.46079464083647,272.9999990463257,297.85713958740234],["C",275.3683009037527,300.92200081466086,278.2787225476033,302.119440134477,282.9999990463257,302.85713958740234],["C",292.63414007560266,304.3624741232269,294.67379879404007,304.2158501469136,304.9999990463257,302.85713958740234],["C",312.8187607206042,301.8283551565762,314.5699081731328,301.3401054770485,320.9999990463257,297.85713958740234],["C",325.23898991150406,295.5610195354307,326.9695880284748,293.9179616231041,328.9999990463257,289.85713958740234],["C",331.62261327771637,284.6119111246209,333.02286007201445,281.35501760047936,331.9999990463257,275.85713958740234],["C",329.63750861502035,263.1587535191362,327.2662997966319,260.7089622986056,320.9999990463257,246.85713958740234],["C",317.9349129049706,240.08168601177525,317.5622018648356,239.49280189262043,312.9999990463257,233.85713958740234],["C",309.4193948782531,229.43404032095978,308.66765091205593,228.87738491228663,303.9999990463257,225.85713958740234],["C",300.7268323852949,223.7392082185001,299.8731264642962,223.43810870009793,295.9999990463257,222.85713958740234],["C",290.4996997545332,222.03209469363347,286.0761236137997,221.3000461617968,283.9999990463257,222.85713958740234],["C",280.6695492193361,225.35497695764457,275.9999990463257,237.85713958740234,275.9999990463257,237.85713958740234]],"stroke-opacity":1,"stroke-width":3,"stroke-linecap":"round","stroke-linejoin":"round","type":"path"},{"fill":"none","stroke":"#FF0000","path":[["M",171.99999904632568,134.85713958740234],["C",171.99999904632568,134.85713958740234,163.68214023456756,143.02987110824122,160.99999904632568,149.85713958740234],["C",159.19537909712042,154.4507176399248,160.6178142980604,162.74934388917367,160.99999904632568,162.85713958740234],["C",165.00625735156802,163.98710987862455,184.6427045476733,159.29006872019292,199.99999904632568,160.85713958740234],["C",204.24122977320232,161.289918233002,205.04679990771774,165.99968991042437,209.99999904632568,167.85713958740234],["C",215.7869049706399,170.02722930902019,221.67411840993526,170.7616487237764,223.99999904632568,169.85713958740234],["C",225.3193010879757,169.34407768231623,227.17850199824625,165.16999908981944,227.99999904632568,160.85713958740234],["C",229.00983932006238,155.55547815028473,229.55262503240814,153.51501754564975,227.99999904632568,148.85713958740234],["C",225.67106006720198,141.87032265003126,223.7755168189131,137.15060012022124,218.99999904632568,133.85713958740234],["C",213.21149265531062,129.8650662142885,208.85296157992764,130.05872038418306,198.99999904632568,128.85713958740234],["C",188.9604715416733,127.63280696488376,187.3058546923344,127.8231556267347,177.99999904632568,128.85713958740234],["C",175.19347115308497,129.16897601998465,173.5328746355813,130.32426399814673,171.99999904632568,131.85713958740234],["C",171.14840149673924,132.7087371369888,170.99999904632568,135.85713958740234,170.99999904632568,135.85713958740234]],"stroke-opacity":1,"stroke-width":3,"stroke-linecap":"round","stroke-linejoin":"round","type":"path"},{"fill":"none","stroke":"#FF0000","path":[["M",101.99999904632568,156.85713958740234],["C",101.99999904632568,156.85713958740234,107.68414645652356,160.85713958740234,111.99999904632568,160.85713958740234],["C",122.789630520831,160.85713958740234,127.09781409534799,161.30301854498416,136.99999904632568,156.85713958740234],["C",148.85547105160896,151.5342746054384,150.2739571417402,148.05088979133276,160.99999904632568,138.85713958740234],["C",163.4871971691281,136.72525548214313,164.08507360528333,135.78490099873787,164.99999904632568,132.85713958740234],["C",166.3014016133256,128.69265137300266,166.64200019973592,123.55750448203167,165.99999904632568,122.85713958740234],["C",165.08117170750003,121.85478249050165,158.96146455897716,119.94318541401918,153.99999904632568,120.85713958740234],["C",142.20248715990778,123.03036546121616,139.55847396520625,123.75077547931451,127.99999904632568,129.85713958740234],["C",114.08019152131801,137.21100016665167,107.07000712035038,142.55366966437668,100.99999904632568,148.85713958740234],["C",100.05077967672511,149.84286739429524,101.99999904632568,156.85713958740234,101.99999904632568,156.85713958740234]],"stroke-opacity":1,"stroke-width":3,"stroke-linecap":"round","stroke-linejoin":"round","type":"path"},{"fill":"none","stroke":"#FF0000","path":[["M",228.99999904632568,128.85713958740234],["C",228.99999904632568,128.85713958740234,226.42279862609774,133.48821059642427,225.99999904632568,137.85713958740234],["C",224.99878615255986,148.20300615631572,224.70707115761397,150.16018042206437,225.99999904632568,159.85713958740234],["C",226.50149834861386,163.61838435456374,227.55231384073224,166.0535820674914,229.99999904632568,167.85713958740234],["C",234.80423224241068,171.39710088978075,237.69240869904775,172.7914493284243,244.99999904632568,173.85713958740234],["C",260.25771065068153,176.08222252970424,275.1535751685043,175.5687455568577,277.9999990463257,174.85713958740234],["C",278.108641179067,174.82997905421703,278.8238928804012,168.77536972192323,276.9999990463257,165.85713958740234],["C",270.3913447644156,155.2832927363462,268.3951131218467,152.74517492753208,257.9999990463257,142.85713958740234],["C",248.5352352758931,133.85407161064938,245.72118639480195,132.04177283992303,235.99999904632568,126.85713958740234],["C",233.45296305982535,125.49872039460216,228.8767113750928,126.52837246411467,227.99999904632568,126.85713958740234],["C",227.8767113750928,126.90337246411467,227.99999904632568,129.85713958740234,227.99999904632568,129.85713958740234]],"stroke-opacity":1,"stroke-width":3,"stroke-linecap":"round","stroke-linejoin":"round","type":"path"}]
var sketchpad = Raphael.sketchpad("canvas", {
	width: 480,
	height: 480,
	strokes: strokes,
	editing: true  /* must set true to get overlay */ });

document.getElementById("test1").innerHTML="blah";

</script>

<div id="save" style="cursor:pointer;margin:4px 0 0;color:#1D72C2;background-color:#D4ECFF;border:1px solid #57B6FF;text-align:center;text-decoration:none;width:50px;float:left">Save</div>
