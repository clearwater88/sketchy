<script type="text/javascript" src="http://cs.brown.edu/people/jchua/sketchy/js/jquery.min.js"></script>
<script type="text/javascript" src="http://cs.brown.edu/people/jchua/sketchy/js/raphael.min.js"></script>
<script type="text/javascript" src="http://cs.brown.edu/people/jchua/sketchy/js/json2.min.js"></script>
<script type="text/javascript" src="http://cs.brown.edu/people/jchua/sketchy/js/raphael.sketchpad.smooth.js"></script>
 
<!-- <div id="viewer" style="border:1px solid #ccc;width:480px;height:480px"></div> -->

<div id="canvas" style="background-image: url(https://cs.brown.edu/people/jchua/sketchy/svgSubset/car/3607.svg);border:1px solid #ccc;width:420px;height:420px"></div>

<p id="test1"> ok </p>


<script>

function saveDaPicture(){
    var img = document.getElementById('canvas').toDataURL("image/png");
    $('body').append('<img src="'+img+'"/>');
}

$('#save').click(function(){
    var svg = $('#ec').html().replace(/>\s+/g, ">").replace(/\s+</g, "<");
                             // strips off all spaces between tags
    //alert(svg);
    canvg('canvas', svg, {renderCallback: saveDaPicture, ignoreMouse: true, ignoreAnimation: true});
});
var strokes = [{"fill":"none","stroke":"#FF0000","path":[["M",183,130.4166717529297],["C",183,130.4166717529297,81.15919219202414,128.30481328662793,35,130.4166717529297],["C",33.34068263362005,130.49258823374447,32.79174629162844,135.6534635687433,30,137.4166717529297],["C",24.915590552676687,140.6278777196602,19.368484696318806,139.2254757248382,16,142.4166717529297],["C",12.886990266604245,145.3658388687783,12.366262833370932,149.1318627194234,11,155.4166717529297],["C",10.03012206273051,159.87811026436935,12.05828249399537,160.91897115344938,11,165.4166717529297],["C",8.26091589789434,177.05777918687875,4.799907866360025,177.71727062158953,3,189.4166717529297],["C",1.0025412702589969,202.40015349624622,0.5712120262716538,205.02985308691513,3,217.4166717529297],["C",5.165159027000131,228.45898279063036,9.583149739671704,229.48275091987915,13,240.4166717529297],["C",14.177096740400179,244.18338132221027,12.761764705882353,248.34461292940028,13,249.4166717529297],["C",13.011764705882353,249.46961292940028,14.895877514896002,249.22144209335968,15,249.4166717529297],["C",16.776589902086968,252.74777781934276,18.35205727212463,260.1799633883291,21,264.4166717529297],["C",21.494282642536742,265.20752398098847,24.156081141957642,264.45219305802414,25,265.4166717529297],["C",29.454016195223538,270.5069759760423,31.381885402882553,273.1804425586948,35,280.4166717529297],["C",36.35679297391904,283.1302577007678,35.40579808721596,286.58478907503206,36,287.4166717529297],["C",36.220074782512604,287.72477644844736,39.68,287.1766717529297,40,287.4166717529297],["C",40.18,287.5516717529297,39.64345038240332,290.1573629401321,40,290.4166717529297],["C",42.39185368471103,292.1562017054468,45.393613165058795,293.4759993869885,51,295.4166717529297],["C",58.21547066974306,297.9143346770715,58.48712093130119,298.5029432175474,66,299.4166717529297],["C",94.91737309950298,302.9336495623287,95.60770428509952,304.05529106791045,125,304.4166717529297],["C",217.054116632872,305.54848466235023,223.44692921589865,307.3391212761961,310,302.4166717529297],["C",322.4226558492453,301.71016999847023,330.1734950670684,295.1058278758212,336,292.4166717529297],["C",336.1756735155658,292.3355916688224,335.95099019885913,290.42484005311985,336,290.4166717529297],["C",340.4843968043879,289.6692722855317,351.82589004104466,289.71517607059815,366,287.4166717529297],["C",369.48069898814776,286.852234079176,370.7040919621494,286.59174252563025,373,284.4166717529297],["C",379.1142363788749,278.6242372887324,381.8805949829143,277.04188401691687,385,269.4166717529297],["C",389.9283750498248,257.3695327422468,389.5793090029333,245.56667661729648,391,240.4166717529297],["C",391.02556924179197,240.3239832514338,392.99841017488075,240.43654456692016,393,240.4166717529297],["C",393.24841017488075,237.31154456692016,395.1599513234284,225.67644053921464,393,215.4166717529297],["C",391.7313128016073,209.3904075605644,389.18560488114423,206.35606458224188,385,202.4166717529297],["C",382.5543413339826,200.1148753613839,378.82161201431813,201.8150419651001,376,199.4166717529297],["C",370.40563505386274,194.66146154871302,371.36921236082543,190.69845761312638,365,185.4166717529297],["C",351.8768116405862,174.53402774756216,348.0179459998295,173.07428704694703,335,165.4166717529297],["C",333.75321080565016,164.6832663444886,331.3576734521845,165.77434520511417,331,165.4166717529297],["C",330.4634898217233,164.88016157465296,331.0934770283262,161.299864737347,330,160.4166717529297],["C",321.7697072524454,153.76912761067405,317.8009645224513,150.9593869532937,305,144.4166717529297],["C",295.9029984204147,139.76709316780833,295.00842741379194,139.459207959826,285,137.4166717529297],["C",271.1693064977028,134.59408124225678,265.9746438591973,136.5986250971291,256,134.4166717529297],["C",254.69667456423554,134.1315693138562,254.50582200749585,131.3578105076146,253,130.4166717529297],["C",251.45995476506104,129.45414348109284,250.4562164191457,129.44051851428063,248,129.4166717529297],["C",199.95145632779685,128.95018103766557,150,129.4166717529297,150,129.4166717529297]],"stroke-opacity":1,"stroke-width":3,"stroke-linecap":"round","stroke-linejoin":"round","type":"path"},{"fill":"none","stroke":"#FF0000","path":[["M",350,202.4166717529297],["C",350,202.4166717529297,341.89111992016575,201.48649492342983,336,202.4166717529297],["C",333.6967049936194,202.78034991183188,331.46326345405953,204.10409196642772,331,205.4166717529297],["C",329.6044903359195,209.37061580115787,331.32556422119484,214.90975340086732,330,219.4166717529297],["C",329.61269522755214,220.73350797925244,326.17387283236997,221.28649834252508,326,222.4166717529297],["C",324.89387283236994,229.60649834252507,325.75187617260787,242.5632477379203,326,245.4166717529297],["C",326.00187617260787,245.4382477379203,327.96423265478154,245.30936971727434,328,245.4166717529297],["C",328.85841628524275,247.99192060865792,329.13887503134725,255.89679682905873,331,260.4166717529297],["C",331.41807879730607,261.43200597495866,334.2519987640676,261.3694700226243,335,262.4166717529297],["C",335.88000145403817,263.6486737885831,335.14693913000474,266.7342230569335,336,267.4166717529297],["C",337.94497878358914,268.972654779801,343.05502121641086,268.86068872605836,345,270.4166717529297],["C",345.85306086999526,271.0991204489259,345.5464389422421,275.2896746567575,346,275.4166717529297],["C",350.64144149105607,276.71627537042536,369.52868337056503,278.3003904331202,370,277.4166717529297],["C",372.05110014661506,273.5708589780265,372.86170047703877,249.49467493318826,370,230.4166717529297],["C",369.1262680458403,224.59179205853158,365.62987803906134,221.3155164174024,361,217.4166717529297],["C",358.092583183914,214.96832074990988,355.34719596765666,216.4453632045028,351,214.4166717529297],["C",348.3815135399495,213.19471140490612,347.18159292119964,212.07090184260917,346,210.4166717529297],["C",345.53182167273224,209.7612220947548,346,207.4166717529297,346,207.4166717529297]],"stroke-opacity":1,"stroke-width":3,"stroke-linecap":"round","stroke-linejoin":"round","type":"path"},{"fill":"none","stroke":"#FF0000","path":[["M",148,232.4166717529297],["C",148,232.4166717529297,143.6689225630088,228.02815884676448,140,227.4166717529297],["C",130.8623060694875,225.89372276451093,127.50244597376933,225.08954212670045,118,227.4166717529297],["C",105.0685637815217,230.58355409214886,93.25539195374019,234.7254564891501,91,239.4166717529297],["C",87.47540749338523,246.74782416668842,89.94055900179993,264.7313549615693,93,279.4166717529297],["C",93.73174258926022,282.92903618137876,97.6374458895695,285.1749690126427,101,287.4166717529297],["C",102.00876623312915,288.0891825750158,104.24060018738385,286.87424331534675,105,287.4166717529297],["C",106.24758540644083,288.3078041861017,106.51234945881146,291.72243483370835,108,292.4166717529297],["C",111.60755256238221,294.1001962820414,114.04543596477757,294.09480342670145,120,294.4166717529297],["C",132.2945797602249,295.0812436318608,133.4294796993951,295.18803977297,145,294.4166717529297],["C",147.3758135017242,294.25828418614805,148.45827676203322,293.7656795861506,150,292.4166717529297],["C",151.68447538963036,290.94275578700314,152.66071604593856,289.79165943135973,153,287.4166717529297],["C",154.89284732265855,274.16674049431987,156.8690694403244,268.89809831492255,155,257.4166717529297],["C",154.08890188723998,251.81992620311814,146,244.4166717529297,146,244.4166717529297]],"stroke-opacity":1,"stroke-width":3,"stroke-linecap":"round","stroke-linejoin":"round","type":"path"},{"fill":"none","stroke":"#FF0000","path":[["M",293,230.4166717529297],["C",293,230.4166717529297,270.39355000506856,229.15817675174702,265,230.4166717529297],["C",264.30012267791375,230.5799764614165,264.56059023964286,234.74137419925623,263,237.4166717529297],["C",261.48718293095845,240.01007244271517,258.3714811787636,240.33637715185372,258,242.4166717529297],["C",256.55009770228037,250.53612462015954,256.0783343947416,256.6319147003199,258,265.4166717529297],["C",258.8798930828425,269.43904013163825,261.7072646849805,271.8837984336839,265,274.4166717529297],["C",266.6008878879653,275.64812397444143,268.86174108202584,274.3475422939426,271,275.4166717529297],["C",272.9737774627454,276.4035604843024,272.8782970654145,278.3558202856369,275,279.4166717529297],["C",279.0665972912889,281.4499703985741,280.1137669851535,281.928048451445,285,282.4166717529297],["C",294.48783109678925,283.3654548626086,304.4577006507592,283.44704051648716,305,282.4166717529297],["C",306.9577006507592,278.69704051648716,305.4945205479452,249.11461695840913,305,244.4166717529297],["C",304.9945205479452,244.36461695840913,302.2967447118515,245.103183659204,301,244.4166717529297],["C",295.24092789736545,241.36775122800552,288,235.4166717529297,288,235.4166717529297]],"stroke-opacity":1,"stroke-width":3,"stroke-linecap":"round","stroke-linejoin":"round","type":"path"},{"fill":"none","stroke":"#FF0000","path":[["M",203,156.36666870117188],["C",203,156.36666870117188,200.16113746369797,158.64786908839355,200,160.36666870117188],["C",198.94613746369797,171.60786908839356,198.04238473309994,186.84951686932433,200,188.36666870117188],["C",203.81825189730623,191.3258139215842,226.44406520485185,189.15988861824079,240,191.36666870117188],["C",241.2224478821587,191.5656718447791,241.6981854679466,195.00505355337927,243,195.36666870117188],["C",247.8378242745229,196.71050877742823,250.50905130233397,196.19246059192383,258,196.36666870117188],["C",271.9614585634518,196.69135378404286,274.7587996127783,197.4205312374739,286,196.36666870117188],["C",287.7187996127783,196.2055312374739,289.80036697247704,194.51455860942875,290,193.36666870117188],["C",291.08036697247707,187.15455860942876,290.92154796404,178.43518250339167,290,173.36666870117188],["C",289.87433436854,172.6755077281419,286.7480012359324,172.41387043147728,286,171.36666870117188],["C",285.11999854596183,170.13466666551847,285.9240065339533,167.077442958059,285,166.36666870117188],["C",281.9786453016766,164.04254970246154,278.77222932992163,162.3287069228255,273,161.36666870117188],["C",264.9038861346554,160.0173163902811,262.116986043553,162.7900659098825,255,161.36666870117188],["C",251.8368950917542,160.73404771952272,251.0563990114235,156.67854615131714,248,156.36666870117188],["C",230.90742074589778,154.62252796095737,206,156.36666870117188,206,156.36666870117188]],"stroke-opacity":1,"stroke-width":3,"stroke-linecap":"round","stroke-linejoin":"round","type":"path"},{"fill":"none","stroke":"#FF0000","path":[["M",183,153.36666870117188],["C",183,153.36666870117188,174.04597003322047,152.47267203081404,166,153.36666870117188],["C",161.10931233274835,153.91007844197762,157.90585426524297,155.4137415685504,156,156.36666870117188],["C",155.83427354215277,156.44953193009547,156.08740992130902,158.34238816747492,156,158.36666870117188],["C",153.0368036676241,159.1897787934985,141.26182615405543,159.0367928768466,138,161.36666870117188],["C",136.12618497532986,162.70510800450768,135.90783753675305,171.18785861296456,135,173.36666870117188],["C",134.94290329957528,173.5037007821912,133.00436681222706,173.3339176094688,133,173.36666870117188],["C",132.75436681222706,175.2089176094688,131.11202034194685,182.7027297270124,133,188.36666870117188],["C",135.30753069317606,195.2892607807001,138.6927106998556,201.9021903391228,143,203.36666870117188],["C",154.60400852515718,207.31203159972532,170.8973515000895,205.92958258488864,183,205.36666870117188],["C",183.96623708886233,205.3217274412248,184.49417799250415,202.3078074558568,186,201.36666870117188],["C",187.54004523493896,200.40414042933503,190.7389923107024,201.01918792441592,191,200.36666870117188],["C",193.7666815065547,193.4499649347851,198.50965196336318,177.3126082737424,198,171.36666870117188],["C",197.8769451999928,169.93102936775446,191.39663930980979,168.48025473516418,188,165.36666870117188],["C",186.55734136841411,164.04423162221815,186.86728797584988,160.98616011249322,186,160.36666870117188],["C",185.22166463705778,159.81071487049886,181.66803139496923,160.8120229644847,181,160.36666870117188],["C",180.5101103103559,160.04007557474247,180.67582179930795,157.04249050047983,180,156.36666870117188],["C",179.32417820069205,155.69084690186392,176,155.36666870117188,176,155.36666870117188]],"stroke-opacity":1,"stroke-width":3,"stroke-linecap":"round","stroke-linejoin":"round","type":"path"},{"fill":"none","stroke":"#FF0000","path":[["M",160,198.36666870117188],["C",160,198.36666870117188,123.39899935203984,195.47315813180595,115,196.36666870117188],["C",114.4852869755757,196.42142540589785,113,200.19701159991342,113,203.36666870117188],["C",113,208.8003665890435,112.68712681508525,211.27466229709194,115,215.36666870117188],["C",118.03277411002065,220.73234597274688,121.48339010744921,223.0544881133013,126,226.36666870117188],["C",126.94754053689877,227.0615317615643,129.5674490407565,225.81877081946342,130,226.36666870117188],["C",133.79203007603476,231.16990679748258,135.35663951983267,237.6070480409418,141,245.36666870117188],["C",142.3870886028694,247.2739155301173,143.77855051222048,248.24325484073967,146,248.36666870117188],["C",167.06794030345748,249.53710982914174,188.34904315932678,250.0959174797469,195,248.36666870117188],["C",195.59451410126835,248.2120950348421,195.57992550493913,237.18699151310236,196,235.36666870117188],["C",196.0146537614556,235.30316906819755,197.99841017488077,235.38654151516232,198,235.36666870117188],["C",198.24841017488077,232.26154151516235,199.03632352941176,220.38446281881895,198,210.36666870117188],["C",197.82132352941176,208.63946281881894,196.1712012497909,206.5496688964517,195,206.36666870117188],["C",185.5799071891818,204.89477919948152,178.2272068537818,207.11341253742643,166,205.36666870117188],["C",163.2428847290492,204.97279509103603,162.72669681909247,201.84087684362274,160,201.36666870117188],["C",153.07702301126525,200.16267270313105,143,201.36666870117188,143,201.36666870117188]],"stroke-opacity":1,"stroke-width":3,"stroke-linecap":"round","stroke-linejoin":"round","type":"path"},{"fill":"none","stroke":"#FF0000","path":[["M",243,196.36666870117188],["C",243,196.36666870117188,213.9794967517112,194.44249082580518,205,196.36666870117188],["C",203.5990634767067,196.66686938473472,203.3807706679923,202.19230781051547,201,205.36666870117188],["C",199.66081649925434,207.1522467021661,196.10914078558292,207.36257347380888,196,208.36666870117188],["C",194.67557991482795,220.55133348475485,194.01295248868777,246.86966643872844,196,251.36666870117188],["C",196.38795248868777,252.24466643872844,206.20383920346018,252.3440199007874,215,251.36666870117188],["C",218.8579652616403,250.93800589432294,219.1752007999833,248.61611212725992,223,248.36666870117188],["C",240.73408223243825,247.21009812079546,256.2794218857536,248.73934592071765,261,248.36666870117188],["C",261.0294218857536,248.36434592071765,260.7302404880916,245.51054044085635,261,245.36666870117188],["C",263.9785946106548,243.77808490882265,270.5875485286868,243.6141395839598,276,240.36666870117188],["C",278.76636408533784,238.70685024996916,278.9660905436697,234.94859827831766,281,233.36666870117188],["C",281.7789440471052,232.76082333120115,283.99123376687083,234.03917952325799,285,233.36666870117188],["C",288.3625541104305,231.12496596088488,289.70772629980553,227.76104957404058,293,225.36666870117188],["C",293.7147699480685,224.84683601166748,295.99429222647785,225.40947700258792,296,225.36666870117188],["C",296.2121389159062,223.7756268318751,297.3233111407139,215.19200722419302,295,210.36666870117188],["C",292.33208290061566,204.82561011014283,289.0897961521601,202.51880244128103,283,198.36666870117188],["C",279.3653243686432,195.8884807707013,277.8495523161655,195.60132445840568,273,195.36666870117188],["C",248.14315315211837,194.1639180472421,221,195.36666870117188,221,195.36666870117188]],"stroke-opacity":1,"stroke-width":3,"stroke-linecap":"round","stroke-linejoin":"round","type":"path"}]
var sketchpad = Raphael.sketchpad("canvas", {
	width: 480,
	height: 480,
	strokes: strokes,
	editing: true  /* must set true to get overlay */ });

document.getElementById("test1").innerHTML="blah";

</script>

<div id="save" style="cursor:pointer;margin:4px 0 0;color:#1D72C2;background-color:#D4ECFF;border:1px solid #57B6FF;text-align:center;text-decoration:none;width:50px;float:left">Save</div>
