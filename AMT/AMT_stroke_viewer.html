<script type="text/javascript" src="http://cs.brown.edu/people/jchua/sketchy/js/jquery.min.js"></script>
<script type="text/javascript" src="http://cs.brown.edu/people/jchua/sketchy/js/raphael.min.js"></script>
<script type="text/javascript" src="http://cs.brown.edu/people/jchua/sketchy/js/json2.min.js"></script>
<script type="text/javascript" src="http://cs.brown.edu/people/jchua/sketchy/js/raphael.sketchpad.smooth.js"></script>
 
<!-- <div id="viewer" style="border:1px solid #ccc;width:480px;height:480px"></div> -->

<div id="canvas" style="background-image: url(https://cs.brown.edu/people/jchua/sketchy/svgSubset/face/6243.svg);border:1px solid #ccc;width:420px;height:420px"></div>

<p id="test1"> ok </p>


<script>

function saveDaPicture(){
    var img = document.getElementById('canvas').toDataURL("image/png");
    $('body').append('<img src="'+img+'"/>');
}

$('#save').click(function(){
    var svg = $('#ec').html().replace(/>\s+/g, ">").replace(/\s+</g, "<");
                             // strips off all spaces between tags
    //alert(svg);
    canvg('canvas', svg, {renderCallback: saveDaPicture, ignoreMouse: true, ignoreAnimation: true});
});
var strokes =  [{"fill":"none","stroke":"#FF0000","path":[["M",167,125],["C",167,125,161.6275134537139,125.14528462090783,159,127],["C",154.51680516960064,130.16460811557602,152.77886264109276,131.90541849132993,150,137],["C",147.45835734046395,141.65967820914943,147.27105665739242,143.10451770171457,147,149],["C",145.32412034458787,185.4503825052137,144.4188770125422,189.61057502279283,146,224],["C",146.25798418320122,229.61115598462635,147.64009850023342,231.17014159408555,151,236],["C",155.04887006572994,241.82025071948678,158.29310805017835,245.65203929097393,162,247],["C",164.448795288064,247.89047101384145,169.6158760178345,246.4440895426751,173,244],["C",176.65542506090452,241.35997078934673,177.28290677284224,239.25304690583837,180,234],["C",184.61561912765285,225.07646968653785,185.04427803143383,224.60609639784008,188,215],["C",190.92394001191494,205.49719496127648,191.2529513276633,204.89839490846103,192,195],["C",193.21430123412347,178.91050864786402,195.798043745396,175.39310162850168,192,162],["C",187.4667401881049,146.01429434752782,182.9482347483403,143.30497653590817,173,128],["C",170.7356229429344,124.51634298912987,169.4322787463613,124.0021626020441,166,122],["C",164.17489939677614,120.93535798145274,161.00873680612193,120.98689479081709,161,121],["C",160.99251130903835,121.01123303644249,164,125,164,125]],"stroke-opacity":1,"stroke-width":3,"stroke-linecap":"round","stroke-linejoin":"round","type":"path"},{"fill":"none","stroke":"#FF0000","path":[["M",232,122],["C",232,122,228.71357818063387,168.22547755463742,231,209],["C",231.5362756540747,218.56358249766538,233.9602087830786,222.53633405292572,238,229],["C",239.4916152185556,231.38658434968895,242.21359400064236,232.34149460880738,246,233],["C",252.5315503488919,234.13592179980728,259.1971153846154,233.36057692307693,261,233],["C",261.07211538461536,232.98557692307693,260.49088999044716,230.62224556723123,261,230],["C",263.6072603519524,226.81334845872482,267.62622626669196,226.23888166662152,270,222],["C",273.6043496870782,215.56366127307467,274.48276539506656,213.2757536789346,275,205],["C",276.88221112553384,174.88462199145823,277.90643095692553,165.57438442839614,275,142],["C",274.48747216654345,137.84282979529695,270.658603655198,135.3645470843097,266,132],["C",262.79322145652463,129.6839932741567,261.3832056806296,129.57172248008212,257,129],["C",250.46577671683914,128.14771000654423,248.89423207680497,130.12271087177237,243,129],["C",239.7321094268054,128.37754465272485,236,125,236,125]],"stroke-opacity":1,"stroke-width":3,"stroke-linecap":"round","stroke-linejoin":"round","type":"path"},{"fill":"none","stroke":"#FF0000","path":[["M",303,217],["C",303,217,288.6074952271191,222.00903472148693,277,228],["C",274.2222389222271,229.43368313691505,274.57452599612026,231.85576622394655,272,233],["C",266.8905561000075,235.27086395555222,263.6954568285645,233.79037325714614,259,236],["C",256.93016596944915,236.97403954378865,256.8202972458521,240.54492568853698,255,241],["C",243.55813159750127,243.86046710062467,236.54284672452766,240.66628904815116,223,245],["C",214.11250683702872,247.8439978121508,211.77373453646624,251.6523148396319,205,257],["C",204.16950381162098,257.6556548855624,204.70118551728635,259.55379103445415,204,260],["C",200.97613745670265,261.9242761639165,198.24876361536437,261.2962413356772,194,264],["C",187.78079528765505,267.9576757260377,187.7210081049047,270.503828380336,182,274],["C",179.91165655066362,275.27620988570555,178.87080803390566,275.14722092481566,176,275],["C",160.00019487999992,274.17949717333335,153.66843473167145,277.65750326679546,143,272],["C",127.58848105779566,263.8272248033765,111.29315849567682,240.3315791014556,110,240],["C",109.98873415125111,239.99711132083362,105.66238217951867,251.19451583312866,104,262],["C",102.76715952458515,270.0134630901965,102.28100227982688,271.69425968926424,104,279],["C",105.90933656808156,287.11468041434665,107.3051023782327,288.37079136462813,112,296],["C",114.98167182294696,300.8452167122888,117.31569951929079,300.20660628444784,120,305],["C",123.85519712956454,311.88428058850815,122.18046529269978,316.7985118219698,126,321],["C",129.33400063433834,324.66740069777217,133.2294474777201,326.0707084773341,140,327],["C",156.96220433491814,329.328145693028,166.3390866488961,329.30011138428097,177,328],["C",178.36786851198025,327.83318676683166,178.70855023278534,323.48270279055066,181,322],["C",185.71970250560628,318.9460748493136,188.36387757147796,320.4442970396524,194,317],["C",205.72079439287805,309.8372923154634,205.15852948201297,307.1048823107922,217,300],["C",224.56142093317246,295.4631474400965,225.64654734078778,294.90936060781996,234,293],["C",242.18664024051827,291.1287679450244,243.74172498288254,293.6516550034235,252,292],["C",257.89876786936964,290.82024642612606,259.1291768039957,290.3210158154575,264,287],["C",269.31623770655335,283.3752924728045,268.6314198613257,281.1484482889756,274,277],["C",279.27222100798014,272.9260110392881,281.8045752872639,274.36324170124556,286,270],["C",293.12874033139184,262.5861100553525,293.83120505712947,260.8881294559263,299,251],["C",305.0568257920862,239.4130289194873,305.57920114282496,237.9727960001127,309,226],["C",310.2279790769346,221.70207323072876,310.2508711548024,218.85913406811977,309,216],["C",307.8663980159603,213.40890975076647,304.7324347696885,211.0509364498802,302,210],["C",300.351506295973,209.36596395998964,298.13825891797416,209.93087054101292,296,211],["C",294.0262225372546,211.9868887313727,293.03508399072166,212.9298320185567,292,215],["C",290.4473740139175,218.10525197216492,290,223,290,223]],"stroke-opacity":1,"stroke-width":3,"stroke-linecap":"round","stroke-linejoin":"round","type":"path"}]

var sketchpad = Raphael.sketchpad("canvas", {
	width: 480,
	height: 480,
	strokes: strokes,
	editing: true  /* must set true to get overlay */ });

document.getElementById("test1").innerHTML="blah";

</script>

<div id="save" style="cursor:pointer;margin:4px 0 0;color:#1D72C2;background-color:#D4ECFF;border:1px solid #57B6FF;text-align:center;text-decoration:none;width:50px;float:left">Save</div>
